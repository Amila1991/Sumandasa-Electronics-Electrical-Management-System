/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package vendor;

import componentControl.AutoGenerate;
import componentControl.ValidationValues;
import control.VendorControl;
import grn.AddGRN;
import grn.GRN;
import java.awt.Font;
import java.sql.SQLException;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import model.Vendor;

/**
 *
 * @author Amila
 */
public class AddNewVendor extends javax.swing.JPanel {

    GRN grn;
    AddGRN addGRN;
    JPanel pan;

    /**
     * Creates new form AddNewEmployee
     */
    public AddNewVendor(GRN grn, JPanel pan) {
        initComponents();
        this.grn=grn;
        this.pan=pan;
        setDefault();
        btBack.setVisible(false);
    }
    
    public AddNewVendor(GRN grn, JPanel pan,AddGRN addGRN) {
        initComponents();
        this.grn=grn;
        this.pan=pan;
        this.addGRN=addGRN;
        setDefault();
        btBack.setVisible(true);
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jLayeredPane1 = new javax.swing.JLayeredPane();
        jLayeredPane3 = new javax.swing.JLayeredPane();
        lbEmlpoyeeID1 = new javax.swing.JLabel();
        txtVendorID = new javax.swing.JTextField();
        lbEmployeeName1 = new javax.swing.JLabel();
        txtVendorName = new javax.swing.JTextField();
        lbEmployeeAddress1 = new javax.swing.JLabel();
        lbEmployeeContact1 = new javax.swing.JLabel();
        txtVendorContact1 = new javax.swing.JTextField();
        txtFax = new javax.swing.JTextField();
        lbEmployeeNIC1 = new javax.swing.JLabel();
        lbWarning = new javax.swing.JLabel();
        lbEmployeeContact2 = new javax.swing.JLabel();
        txtVendorContact2 = new javax.swing.JTextField();
        lbEmployeeContact3 = new javax.swing.JLabel();
        txtVendorContact3 = new javax.swing.JTextField();
        txtVendorAddress = new javax.swing.JTextField();
        lbEmployeeNIC2 = new javax.swing.JLabel();
        txtEmail = new javax.swing.JTextField();
        lbWarning1 = new javax.swing.JLabel();
        lbWarning2 = new javax.swing.JLabel();
        lbWarning3 = new javax.swing.JLabel();
        btNewEmployee = new javax.swing.JButton();
        btBack = new javax.swing.JButton();
        jLabel3 = new javax.swing.JLabel();

        setOpaque(false);

        jLayeredPane3.setBorder(javax.swing.BorderFactory.createTitledBorder("New Employee Detail"));

        lbEmlpoyeeID1.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        lbEmlpoyeeID1.setText("New Vendor ID");
        lbEmlpoyeeID1.setBounds(30, 40, 120, 15);
        jLayeredPane3.add(lbEmlpoyeeID1, javax.swing.JLayeredPane.DEFAULT_LAYER);

        txtVendorID.setEditable(false);
        txtVendorID.setOpaque(false);
        txtVendorID.setBounds(180, 40, 160, 25);
        jLayeredPane3.add(txtVendorID, javax.swing.JLayeredPane.DEFAULT_LAYER);

        lbEmployeeName1.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        lbEmployeeName1.setText("New Vendor Name");
        lbEmployeeName1.setBounds(30, 90, 140, 15);
        jLayeredPane3.add(lbEmployeeName1, javax.swing.JLayeredPane.DEFAULT_LAYER);

        txtVendorName.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                txtVendorNameFocusGained(evt);
            }
        });
        txtVendorName.setBounds(180, 90, 480, 25);
        jLayeredPane3.add(txtVendorName, javax.swing.JLayeredPane.DEFAULT_LAYER);

        lbEmployeeAddress1.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        lbEmployeeAddress1.setText("Vendor Address");
        lbEmployeeAddress1.setBounds(30, 140, 120, 15);
        jLayeredPane3.add(lbEmployeeAddress1, javax.swing.JLayeredPane.DEFAULT_LAYER);

        lbEmployeeContact1.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        lbEmployeeContact1.setText("Contact 1");
        lbEmployeeContact1.setBounds(30, 190, 140, 15);
        jLayeredPane3.add(lbEmployeeContact1, javax.swing.JLayeredPane.DEFAULT_LAYER);

        txtVendorContact1.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txtVendorContact1KeyReleased(evt);
            }
        });
        txtVendorContact1.setBounds(180, 190, 290, 25);
        jLayeredPane3.add(txtVendorContact1, javax.swing.JLayeredPane.DEFAULT_LAYER);
        txtFax.setBounds(180, 310, 290, 25);
        jLayeredPane3.add(txtFax, javax.swing.JLayeredPane.DEFAULT_LAYER);

        lbEmployeeNIC1.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        lbEmployeeNIC1.setText("FAX");
        lbEmployeeNIC1.setBounds(30, 310, 120, 15);
        jLayeredPane3.add(lbEmployeeNIC1, javax.swing.JLayeredPane.DEFAULT_LAYER);

        lbWarning.setForeground(new java.awt.Color(255, 0, 0));
        lbWarning.setBounds(510, 310, 160, 20);
        jLayeredPane3.add(lbWarning, javax.swing.JLayeredPane.DEFAULT_LAYER);

        lbEmployeeContact2.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        lbEmployeeContact2.setText("Contact 2");
        lbEmployeeContact2.setBounds(30, 230, 140, 15);
        jLayeredPane3.add(lbEmployeeContact2, javax.swing.JLayeredPane.DEFAULT_LAYER);

        txtVendorContact2.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txtVendorContact2KeyReleased(evt);
            }
        });
        txtVendorContact2.setBounds(180, 230, 290, 25);
        jLayeredPane3.add(txtVendorContact2, javax.swing.JLayeredPane.DEFAULT_LAYER);

        lbEmployeeContact3.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        lbEmployeeContact3.setText("Contact 3");
        lbEmployeeContact3.setBounds(30, 270, 140, 15);
        jLayeredPane3.add(lbEmployeeContact3, javax.swing.JLayeredPane.DEFAULT_LAYER);

        txtVendorContact3.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txtVendorContact3KeyReleased(evt);
            }
        });
        txtVendorContact3.setBounds(180, 270, 290, 25);
        jLayeredPane3.add(txtVendorContact3, javax.swing.JLayeredPane.DEFAULT_LAYER);
        txtVendorAddress.setBounds(180, 140, 690, 30);
        jLayeredPane3.add(txtVendorAddress, javax.swing.JLayeredPane.DEFAULT_LAYER);

        lbEmployeeNIC2.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        lbEmployeeNIC2.setText("E-mail");
        lbEmployeeNIC2.setBounds(30, 350, 120, 15);
        jLayeredPane3.add(lbEmployeeNIC2, javax.swing.JLayeredPane.DEFAULT_LAYER);
        txtEmail.setBounds(180, 350, 290, 25);
        jLayeredPane3.add(txtEmail, javax.swing.JLayeredPane.DEFAULT_LAYER);

        lbWarning1.setForeground(new java.awt.Color(255, 0, 0));
        lbWarning1.setBounds(510, 190, 160, 20);
        jLayeredPane3.add(lbWarning1, javax.swing.JLayeredPane.DEFAULT_LAYER);

        lbWarning2.setForeground(new java.awt.Color(255, 0, 0));
        lbWarning2.setBounds(510, 230, 160, 20);
        jLayeredPane3.add(lbWarning2, javax.swing.JLayeredPane.DEFAULT_LAYER);

        lbWarning3.setForeground(new java.awt.Color(255, 0, 0));
        lbWarning3.setBounds(510, 270, 160, 20);
        jLayeredPane3.add(lbWarning3, javax.swing.JLayeredPane.DEFAULT_LAYER);

        jLayeredPane3.setBounds(30, 90, 940, 420);
        jLayeredPane1.add(jLayeredPane3, javax.swing.JLayeredPane.DEFAULT_LAYER);

        btNewEmployee.setText("Create New Employee");
        btNewEmployee.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btNewEmployeeActionPerformed(evt);
            }
        });
        btNewEmployee.setBounds(803, 530, 170, 30);
        jLayeredPane1.add(btNewEmployee, javax.swing.JLayeredPane.DEFAULT_LAYER);

        btBack.setText("Back");
        btBack.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btBackActionPerformed(evt);
            }
        });
        btBack.setBounds(700, 530, 90, 30);
        jLayeredPane1.add(btBack, javax.swing.JLayeredPane.DEFAULT_LAYER);

        jLabel3.setFont(new java.awt.Font("Andalus", 1, 32)); // NOI18N
        jLabel3.setText("Add New Vendor");
        jLabel3.setBounds(30, 10, 310, 50);
        jLayeredPane1.add(jLabel3, javax.swing.JLayeredPane.DEFAULT_LAYER);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
        this.setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jLayeredPane1, javax.swing.GroupLayout.DEFAULT_SIZE, 1000, Short.MAX_VALUE)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jLayeredPane1, javax.swing.GroupLayout.DEFAULT_SIZE, 570, Short.MAX_VALUE)
        );
    }// </editor-fold>//GEN-END:initComponents

    private void txtVendorNameFocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtVendorNameFocusGained
        txtVendorName.selectAll();
    }//GEN-LAST:event_txtVendorNameFocusGained

    private void txtVendorContact1KeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtVendorContact1KeyReleased
        ValidationValues.ValidateTP(txtVendorContact1, lbWarning);
    }//GEN-LAST:event_txtVendorContact1KeyReleased

    private void btNewEmployeeActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btNewEmployeeActionPerformed
        addVendor();
    }//GEN-LAST:event_btNewEmployeeActionPerformed

    private void txtVendorContact2KeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtVendorContact2KeyReleased
        // TODO add your handling code here:
    }//GEN-LAST:event_txtVendorContact2KeyReleased

    private void txtVendorContact3KeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtVendorContact3KeyReleased
        // TODO add your handling code here:
    }//GEN-LAST:event_txtVendorContact3KeyReleased

    private void btBackActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btBackActionPerformed
        this.setVisible(false);
        pan.removeAll();
        addGRN.setVisible(true);
        pan.add(addGRN);
        pan.revalidate();
    }//GEN-LAST:event_btBackActionPerformed

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btBack;
    private javax.swing.JButton btNewEmployee;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLayeredPane jLayeredPane1;
    private javax.swing.JLayeredPane jLayeredPane3;
    private javax.swing.JLabel lbEmlpoyeeID1;
    private javax.swing.JLabel lbEmployeeAddress1;
    private javax.swing.JLabel lbEmployeeContact1;
    private javax.swing.JLabel lbEmployeeContact2;
    private javax.swing.JLabel lbEmployeeContact3;
    private javax.swing.JLabel lbEmployeeNIC1;
    private javax.swing.JLabel lbEmployeeNIC2;
    private javax.swing.JLabel lbEmployeeName1;
    private javax.swing.JLabel lbWarning;
    private javax.swing.JLabel lbWarning1;
    private javax.swing.JLabel lbWarning2;
    private javax.swing.JLabel lbWarning3;
    private javax.swing.JTextField txtEmail;
    private javax.swing.JTextField txtFax;
    private javax.swing.JTextField txtVendorAddress;
    private javax.swing.JTextField txtVendorContact1;
    private javax.swing.JTextField txtVendorContact2;
    private javax.swing.JTextField txtVendorContact3;
    private javax.swing.JTextField txtVendorID;
    private javax.swing.JTextField txtVendorName;
    // End of variables declaration//GEN-END:variables

    private void setDefault() {
        txtVendorID.setText(AutoGenerate.getNextID("Vendor", "Vendor_ID", "VI"));
        txtVendorName.setFont(new Font("new Employee Name", Font.ITALIC, 11));
        txtVendorName.setText("new Employee Name");
    }

    private void addVendor() {
        try {
            Vendor vendor = new Vendor(txtVendorID.getText(), txtVendorName.getText(), txtVendorAddress.getText(), txtVendorContact1.getText(), txtVendorContact2.getText(), txtVendorContact3.getText(), txtFax.getText(), txtEmail.getText());
            int res = VendorControl.addVendor(vendor);
            if (res == 1) {
                JOptionPane.showMessageDialog(pan, "Vendor Create OK...", "Success", JOptionPane.INFORMATION_MESSAGE);
            } else {
                JOptionPane.showMessageDialog(pan, "Vendor Create Fail", "Fail", JOptionPane.ERROR_MESSAGE);
            }
        } catch (ClassNotFoundException ex) {
            Logger.getLogger(AddNewVendor.class.getName()).log(Level.SEVERE, null, ex);
        } catch (SQLException ex) {
            Logger.getLogger(AddNewVendor.class.getName()).log(Level.SEVERE, null, ex);
        }
    }
}
